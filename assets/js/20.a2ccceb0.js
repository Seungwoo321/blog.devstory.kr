(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{528:function(s,t,a){s.exports=a.p+"assets/img/01_trade.848e0ca9.png"},529:function(s,t,a){s.exports=a.p+"assets/img/02_chart.6e0f1104.png"},604:function(s,t,a){"use strict";a.r(t);var n=a(45),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"influxdb를-활용한-주식차트-만들기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#influxdb를-활용한-주식차트-만들기"}},[s._v("#")]),s._v(" InfluxDB를 활용한 주식차트 만들기")]),s._v(" "),n("p",[s._v("트레이딩 봇 개발 2탄")]),s._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#배경"}},[s._v("배경")])]),n("li",[n("a",{attrs:{href:"#데이터-수집"}},[s._v("데이터 수집")])]),n("li",[n("a",{attrs:{href:"#시장-데이터-가공"}},[s._v("시장 데이터 가공")])]),n("li",[n("a",{attrs:{href:"#실시간-캔들-생성"}},[s._v("실시간 캔들 생성")]),n("ul",[n("li",[n("a",{attrs:{href:"#연속-쿼리-형식"}},[s._v("연속 쿼리 형식")])]),n("li",[n("a",{attrs:{href:"#연속-쿼리-적용하기"}},[s._v("연속 쿼리 적용하기")])])])]),n("li",[n("a",{attrs:{href:"#캔들-스틱-차트그리기"}},[s._v("캔들 스틱 차트그리기")])]),n("li",[n("a",{attrs:{href:"#정리"}},[s._v("정리")])]),n("li",[n("a",{attrs:{href:"#참고-링크"}},[s._v("참고 링크")])])])]),n("p"),s._v(" "),n("blockquote",[n("p",[s._v("이 글은 2020년 10월경 진행하면서 기록한 내용을 바탕으로 재작성되었습니다.")])]),s._v(" "),n("h2",{attrs:{id:"배경"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#배경"}},[s._v("#")]),s._v(" 배경")]),s._v(" "),n("ul",[n("li",[s._v("이전 글에서 진행했던 Amazon Athena SQL로 캔들 데이터 생성하는 방법은 SQL 구문이 길고 복잡하고 비용이 많이 들었다.")]),s._v(" "),n("li",[s._v('구글 검색을 통해서 실시간 데이터 처리에 용이한 "시계열 데이터 베이스(TSBD)"의 존재를 알았다.')]),s._v(" "),n("li",[s._v("캔들스틱 차트 분석을 학습하면서 차트의 기술적 분석에 흥미가 생겼다.")]),s._v(" "),n("li",[s._v("다이내믹한 암호화폐 시장을 경험하면서 기계적 매매의 필요성과 중요성을 깨달았다.")])]),s._v(" "),n("h2",{attrs:{id:"데이터-수집"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#데이터-수집"}},[s._v("#")]),s._v(" 데이터 수집")]),s._v(" "),n("p",[s._v('지난번에는 막연히 차트의 기본이 되는 캔들(Candle) 데이터에 대한 흥미로 시작했었다면 이번에는 "실시간 시장 데이터를 분석해서 자동으로 사고파는 프로그램을 만들자"라는 구체적인 목표를 갖고 시작했다.')]),s._v(" "),n("p",[s._v("그 첫 번째 작업으로 거래소의 이벤트를 구독해서 웹 소켓 통신으로 시장 데이터를 제공받고 인플럭스DB(InfluxDB)에 저장하는 노드 (node.js) 서버를 구현했다. 관계형 데이터베이스의 테이블(table)에 대응되는 개념으로 시계열 데이터베이스인 인플럭스DB에는 메저 먼트 (measurements)라는 게 있어서 "),n("code",[s._v("trade")]),s._v("라는 이름으로 메저 먼트를 생성해 다음과 같이 실시간 시장 데이터를 저장했다.")]),s._v(" "),n("p",[n("img",{attrs:{src:a(528),alt:"01_trade.png"}})]),s._v(" "),n("h2",{attrs:{id:"시장-데이터-가공"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#시장-데이터-가공"}},[s._v("#")]),s._v(" 시장 데이터 가공")]),s._v(" "),n("p",[s._v("실시간으로 저장되는 시장 데이터를 "),n("code",[s._v("first")]),s._v(", "),n("code",[s._v("last")]),s._v(", "),n("code",[s._v("max")]),s._v(", "),n("code",[s._v("min")]),s._v(" 함수와 "),n("code",[s._v("group by time")]),s._v("을 사용해서 쉽게 원하는 타임 프레임(Timeframe)의 캔들로 가공할 수 있다.")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 30분 캔들")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("first")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" high"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" low"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("last")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("grossValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" volume \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" trade \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" symbol"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XBTUSD'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" fill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("previous"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 4시간 캔들")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("first")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" high"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" low"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("last")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("grossValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" volume \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" trade \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" symbol"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XBTUSD'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("h"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" fill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("previous"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h2",{attrs:{id:"실시간-캔들-생성"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#실시간-캔들-생성"}},[s._v("#")]),s._v(" 실시간 캔들 생성")]),s._v(" "),n("p",[s._v("이전에 AWS 글루(Glue) 서비스의 ETL 작업으로 어떻게 해야 될까 고민했던 실시간으로 시장 데이터를 캔들 데이터로 갱신하는 문제 역시 인플럭스DB의 연속 쿼리를 사용해서 쉽게 해결할 수 있었다.")]),s._v(" "),n("h3",{attrs:{id:"연속-쿼리-형식"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#연속-쿼리-형식"}},[s._v("#")]),s._v(" 연속 쿼리 형식")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" CONTINUOUS QUERY "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("cq_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("database_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nRESAMPLE EVERY "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("infterval"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interval")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("cq_query"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"연속-쿼리-적용하기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#연속-쿼리-적용하기"}},[s._v("#")]),s._v(" 연속 쿼리 적용하기")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 30분 캔들")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v("\n    CONTINUOUS QUERY trade_bitmex_to_xbt_usd_candles_30m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" bitmex \nRESAMPLE EVERY "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("s "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("h \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" \n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("first")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" high"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" low"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("last")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("grossValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" volume \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" trade_bitmex_to_xbt_usd_candles_30m \n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" bitmex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("autogen"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("trade\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" symbol"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XBTUSD'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" fill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("previous"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 4시간 캔들")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v("\n    CONTINUOUS QUERY trade_bitmex_to_xbt_usd_candles_4h "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" bitmex\nRESAMPLE EVERY "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("s "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("h\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("first")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" high"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("min")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" low"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("last")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("grossValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" volume\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" trade_bitmex_to_xbt_usd_candles_4h\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" trade\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" symbol"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XBTUSD'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("h"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" fill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("previous"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h2",{attrs:{id:"캔들-스틱-차트그리기"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#캔들-스틱-차트그리기"}},[s._v("#")]),s._v(" 캔들 스틱 차트그리기")]),s._v(" "),n("p",[s._v("백엔드는 인플럭스DB에서 가공한 캔들 스틱 데이터를 조회하는 새로운 노드 서버를 추가하고 프런트엔드는 뷰(Vue.js)와 오픈소스 (tvjsx/trading-vue-js)를 사용해서 캔들 스틱과 차트의 기술적분석에 주로 사용하려는 이동 평균선(Moving Average), 스토캐스틱(Stochastic), 볼린저 밴드(Bollinger Band) 지표를 시각화했다.")]),s._v(" "),n("p",[n("img",{attrs:{src:a(529),alt:"02_chart.png"}})]),s._v(" "),n("h2",{attrs:{id:"정리"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#정리"}},[s._v("#")]),s._v(" 정리")]),s._v(" "),n("p",[s._v("인플럭스DB를 사용함으로써 손쉽게 시장 데이터를 캔들로 변환할 수 있어서 알고리즘 매매에 사용할 수 있는 보조지표 값들을 구할 수 있게 되었다. 이 보조지표 값들을 가지고 백테스팅(Backtesting)을 해서 매매 전략을 만들고 거래소의 REST API를 통해서 실제로 사고파는 트레이딩 봇을 만들 수 있게 되었다.")]),s._v(" "),n("h2",{attrs:{id:"참고-링크"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#참고-링크"}},[s._v("#")]),s._v(" 참고 링크")]),s._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/blog/2021/04/25/making-trading-bot-1.html"}},[s._v("이전 포스팅 - Amazon Athena SQL로 캔들 데이터 생성하기")])],1),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/tvjsx/trading-vue-js",target:"_blank",rel:"noopener noreferrer"}},[s._v("오픈소스 tvjsx/trading-vue-js"),n("OutboundLink")],1)])]),s._v(" "),n("Comment")],1)}),[],!1,null,null,null);t.default=e.exports}}]);